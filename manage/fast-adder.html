<!DOCTYPE html>

<!-- // -->
<html lang="en" class="hydrated">

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="title"></title>
    <link href="./favicon.png" rel="icon" type="image/x-icon">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link
        href="https://fonts.googleapis.com/css2?family=Josefin+Sans:wght@300;400;500;600;700&amp;family=Roboto:wght@400;500;700&amp;display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <!-- //sweetalert -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="./css/all.css">
    <link rel="stylesheet" href="./css/alll.css">
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="./js/static.js"></script>
    <script src="./js/toAll.js"></script>
    <script src="./js/checkUserAuthStatus.js"></script>
    <script src="./js/inithialize-firebase.js"></script>
    <script src="./js/checkavailableitems.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script>
        // Function to check if the user is authenticated before fetching size charts
        function checkAuthAndFetchSizeCharts() {
            firebase.auth().onAuthStateChanged(async (user) => {
                if (user) {
                    checkavailableitems(user)
                    try {
                        // Get the ID token
                        const idToken = await user.getIdToken();

                        // Construct the URL with the user's UID
                        const url = `https://matager-f1f00-default-rtdb.firebaseio.com/Stores/${user.uid}/sizecharts.json?auth=${idToken}`;

                        // Fetch size charts
                        const response = await fetch(url, {
                            headers: {
                                Authorization: `Bearer ${idToken}` // Send token for authentication
                            }
                        });

                        const sizeCharts = await response.json();
                        const selectElement = document.getElementById('size-chart');
                        const selectElementArea = document.getElementById('size-chart-area');

                        // Clear previous options
                        selectElement.innerHTML = "";

                        // Check if size charts exist
                        if (!sizeCharts || Object.keys(sizeCharts).length === 0) {
                            console.warn("No size charts found.");

                            // Create a disabled placeholder option
                            const placeholderOption = document.createElement("option");
                            placeholderOption.value = "";
                            placeholderOption.disabled = true;
                            placeholderOption.selected = true;
                            placeholderOption.textContent = "No size charts available";
                            selectElement.appendChild(placeholderOption);

                            // Keep select disabled if no size charts are available
                            selectElement.disabled = true;

                            // Ensure "Add Chart" link is present without overwriting the container
                            if (!document.getElementById('addChart')) {
                                const addChartLink = document.createElement("a");
                                addChartLink.href = "./sizecharts.html";
                                addChartLink.classList.add('addchartlink');
                                addChartLink.id = "addChart";
                                addChartLink.textContent = "Add a Chart";
                                selectElementArea.appendChild(addChartLink);
                            }

                            return;
                        }

                        // Add default "Select a size chart" option
                        const defaultOption = document.createElement("option");
                        defaultOption.value = "";
                        defaultOption.disabled = true;
                        defaultOption.selected = true;
                        defaultOption.textContent = "Select a size chart";
                        selectElement.appendChild(defaultOption);

                        // Populate dropdown with size charts
                        Object.entries(sizeCharts).forEach(([chartId, chart]) => {
                            const option = document.createElement("option");
                            option.value = chart.sizeChartUrl;
                            option.setAttribute("data-id", chartId);
                            option.textContent = chart.chartName;
                            selectElement.appendChild(option);
                        });

                        // // Append "Add Chart" below the dropdown (if not already added)
                        // if (!document.getElementById('addChart')) {
                        //     const addChartLink = document.createElement("a");
                        //     addChartLink.href = "./sizecharts.html";
                        //     addChartLink.id = "addChart";
                        //     addChartLink.classList.add('addchartlink');
                        //     addChartLink.textContent = "Add a Chart";
                        //     selectElementArea.appendChild(addChartLink);
                        // }


                        // Add event listener to handle selection
                        selectElement.addEventListener("change", function () {
                            const selectedOption = this.options[this.selectedIndex];
                            const selectedChartId = selectedOption.getAttribute("data-id");
                            const selectedChartUrl = selectedOption.value;

                            if (!selectedChartId) return;

                            // Remove 'selected' attribute from all options
                            Array.from(this.options).forEach(opt => opt.removeAttribute("selected"));

                            // Set 'selected' attribute to the chosen option
                            selectedOption.setAttribute("selected", "selected");

                        });

                    } catch (error) {
                        console.error("Error fetching size charts:", error);
                    }
                } else {
                    // Redirect if user is not authenticated
                    console.error("User is not authenticated. Redirecting...");
                    window.location.href = './index.html';
                }
            });
        }
        document.addEventListener("DOMContentLoaded", checkAuthAndFetchSizeCharts);
    </script>
    <script src="./js/Logout.js"></script>

</head>

<body id="top" onload="checkAuthAndRedirect()">

    <main>
        <div class="formbold-form-wrapper">
            <div class="mb-20 flex align-items space-between">

                <div class="profile-icon profile-icon-img" onclick="toggleDropdown()">
                    <!-- <span><i class="bi bi-diagram-3"></i></span> -->
                    <div id="dropdown" class="dropdown-menu">
                        <a href="./main.html" class="center align-items"><i class="bi bi-house-door mr-5"></i> Home
                        </a>
                        <a href="./profile.html" class="center align-items"><i class="bi bi-person-circle mr-5"></i>
                            Profile</a>
                        <a href="#settings" class="center align-items"><i class="bi bi-gear-fill mr-5"></i> Settings</a>
                        <a href="#logout" id="logoutLink" class="center align-items"><i
                                class="bi bi-box-arrow-left mr-5"></i>
                            Logout</a>
                    </div>
                </div>
                <div>
                    <label class="day-night">
                        <input type="checkbox" checked />
                        <div></div>
                    </label>
                </div>

            </div>
            <form class="addProduct" id="add-product-form">
                <div class="progress-container">
                    <div class="flex">
                        <span class="stock-count stock-count-card flex align-items-center" id="stockCount">Available
                            Products: <div class="spinner-sm spinner-sm-available-items ml-auto">
                            </div>
                            <p id="available-items-stock"></p>
                        </span>
                        <span class="stock-count stock-count-card flex align-items-center" id="">Uploaded Products: <div
                                class="spinner-sm spinner-sm-available-items ml-auto">
                            </div>
                            <p id="total-products-count"></p>
                        </span>
                    </div>

                    <div class="progress hidden" id="progress-bar-area">
                        <div class="progress-bar" id="progressBar"></div>
                    </div>

                </div>


                <div class="preview-area">

                    <button type="button" class="formbold-form-label point no-bg-i:hover line-height preview-btn"
                        id="previewButton">
                        Preview
                    </button>
                </div>



                <div class="formbold-input-group fastadder-container">
                    <div class="flex center align-items gap-30 col590 fastadder-row">
                        <div class="flex gap-10 prices center fastadder-prices hidden">


                            <div class="formbold-input-group m-LR-2 w-auto fastadder-input-group hidden">
                                <label for="priceplusthecut"
                                    class="formbold-form-label fastadder-label">Price+cut</label>
                                <input type="text" name="priceplusthecut" id="priceplusthecut" placeholder="EGP"
                                    class="formbold-form-input shadow fastadder-input" readonly>
                            </div>



                            <div class="formbold-input-group m-LR-2 w-auto fastadder-input-group hidden">
                                <label for="Storeprice" class="formbold-form-label fastadder-label">Final Price</label>
                                <input type="text" name="Storeprice" id="Storeprice" placeholder="EGP"
                                    class="formbold-form-input shadow fastadder-input" readonly>
                            </div>
                        </div>

                        <div
                            class="flex center input-set mb-3 flex-wrap mb-30 add-product-cart product-record shadow fastadder-product-record">
                            <div class="product-data fastadder-product-data" id="product-data">
                                <div
                                    class="flex mb-10 minline-140 p5 center align-items gap-10 align-flex-start-SQ fastadder-size-quantity">
                                    <div class="formbold-input-group fastadder-input-group">
                                        <label for="producttitle"
                                            class="formbold-form-label fastadder-label">Product-Title</label>
                                        <input type="text" name="product-title" id="producttitle"
                                            placeholder="Enter your product title"
                                            class="formbold-form-input shadow fastadder-input" />
                                    </div>

                                    <div class="formbold-input-group m-LR-2 w-auto fastadder-input-group">
                                        <label for="brandname"
                                            class="formbold-form-label fastadder-label">Brand-Name</label>
                                        <input type="text" name="Brand-Name" id="brandname"
                                            placeholder="Enter your brand name"
                                            class="formbold-form-input shadow fastadder-input" />
                                    </div>

                                    <div class="formbold-input-group m-LR-2 w-auto fastadder-input-group">
                                        <label for="productprice"
                                            class="formbold-form-label fastadder-label">Price</label>
                                        <input type="text" name="Product-Price" id="productprice" placeholder="EGP"
                                            class="formbold-form-input shadow fastadder-input" />
                                    </div>
                                    <div class="formbold-input-group m-LR-2 w-auto fastadder-input-group">
                                        <label for="sale-amount"
                                            class="formbold-form-label fastadder-label">Sale</label>
                                        <input type="text" name="sale-amount" id="sale-amount" placeholder="%"
                                            class="formbold-form-input shadow fastadder-input" />
                                    </div>
                                    <div class="formbold-input-group m-LR-2 w-auto fastadder-input-group">
                                        <label for="finalprice-2" class="formbold-form-label fastadder-label">Store
                                            Price</label>
                                        <input type="text" id="finalprice" placeholder="EGP"
                                            class="formbold-form-input shadow fastadder-input" readonly>
                                    </div>
                                    <div class="formbold-input-group m-LR-2 w-auto fastadder-input-group"
                                        id="size-chart-area">
                                        <label for="chart" class="formbold-form-label fastadder-label">Charts</label>
                                        <div class="shadow mb-10 w-170 fastadder-select-container">
                                            <select id="size-chart"
                                                class="formbold-form-input font-sm chart-sel fastadder-select">
                                            </select>
                                        </div>
                                    </div>
                                    <div class="input-group flex fastadder-input-group">
                                        <div class="input-group flex fastadder-input-group">
                                            <div class="input-group flex column fastadder-input-group">
                                                <label class="font-sm m510 fastadder-label m510" for="fromSize">From
                                                    Size</label>
                                                <div class="input-with-buttons column fastadder-input-buttons">
                                                    <input id="fromSize" type="text" name="size" placeholder="Size"
                                                        class="formbold-form-input m-LR-2 max-150 fastadder-input"
                                                        value="0">
                                                    <div class="flex gap-20 fastadder-button-group">
                                                        <button type="button" class="decrement-btn fastadder-btn"
                                                            onclick="fastadderdecrement(event)">
                                                            <i class="bi bi-dash-circle"></i>
                                                        </button>
                                                        <button type="button" class="increment-btn fastadder-btn"
                                                            onclick="fastadderincrement(event)">
                                                            <i class="bi bi-plus-circle"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="input-group flex column fastadder-input-group relative">
                                                <label class=" font-sm m510 fastadder-label m510" for="toSize">To
                                                    Size</label>
                                                <div class="input-with-buttons column fastadder-input-buttons">
                                                    <input id="toSize" type="text" name="size" placeholder="Size"
                                                        class="formbold-form-input m-LR-2 max-150 fastadder-input"
                                                        value="0">
                                                    <div class="flex gap-20 fastadder-button-group">
                                                        <button type="button" class="decrement-btn fastadder-btn"
                                                            onclick="fastadderdecrement(event)">
                                                            <i class="bi bi-dash-circle"></i>
                                                        </button>
                                                        <button type="button" class="increment-btn fastadder-btn"
                                                            onclick="fastadderincrement(event)">
                                                            <i class="bi bi-plus-circle"></i>
                                                        </button>
                                                    </div>
                                                </div>

                                            </div>
                                            <button type="button" class="toggle-btn fastadder-btn"
                                                onclick="toggleSize(event)">
                                                <i class="bi bi-arrow-repeat"></i>
                                            </button>

                                        </div>

                                    </div>



                                    <div class="input-group flex column fastadder-input-group">
                                        <label class="font-sm m510 fastadder-label" for="quantity1">Quantity</label>
                                        <div class="input-with-buttons fastadder-input-buttons column">
                                            <input id="quantity1" type="text" name="quantity" placeholder="Quantity"
                                                class="formbold-form-input m-LR-2 max-200 fastadder-input" value="3">
                                            <div class="flex gap-10">
                                                <button type="button" class="decrement-btn fastadder-btn"
                                                    onclick="decrement('quantity1')"><i
                                                        class="bi bi-dash-circle"></i></button>
                                                <button type="button" class="increment-btn fastadder-btn"
                                                    onclick="increment('quantity1')"><i
                                                        class="bi bi-plus-circle"></i></button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="flex center fastadder-toggle-images">
                                    <button type="button" class="show-img-url" onclick="toggleImageInputs()">Show Images
                                        Urls <i class="bi bi-eye-fill"></i></button>
                                </div>

                                <div class="flex flex-wrap mb-3 imgids " id="image-inputs">
                                    <input type="text" id="img1_1" name="product-photo" placeholder="pic url 1"
                                        class="formbold-form-input m-LR-2 mb-10 fastadder-input">
                                    <input type="text" id="img2_1" name="product-photo2" placeholder="pic url 2"
                                        class="formbold-form-input m-LR-2 mb-10 fastadder-input">
                                    <input type="text" id="img3_1" name="product-photo3" placeholder="pic url 3"
                                        class="formbold-form-input m-LR-2 mb-10 fastadder-input">
                                    <input type="text" id="img4_1" name="product-photo4" placeholder="pic url 4"
                                        class="formbold-form-input m-LR-2 mb-10 fastadder-input">
                                    <input type="text" id="img5_1" name="product-photo5" placeholder="pic url 5"
                                        class="formbold-form-input m-LR-2 mb-10 fastadder-input">
                                    <input type="text" id="img6_1" name="product-photo6" placeholder="pic url 6"
                                        class="formbold-form-input m-LR-2 mb-10 fastadder-input">
                                </div>

                                <!-- Combined Drop Zone for all images -->
                                <div class="fastadder-dropzone-container">
                                    <div class="fastadder-master-dropzone" id="masterDropZone"
                                        ondragover="handleDragOver(event, this)"
                                        ondragleave="handleDragLeave(event, this)"
                                        ondrop="handleMasterDrop(event, this)">
                                        <div class="fastadder-dropzone-content">
                                            <i class="bi bi-cloud-arrow-up"></i>
                                            <p>Drag & Drop all product images here (up to 6)</p>
                                            <p class="fastadder-dropzone-hint">First 2 images will be considered as main
                                                images</p>
                                        </div>
                                    </div>
                                    <div id="masterUploadStatus" class="fastadder-upload-status"></div>

                                    <div class="fastadder-image-previews" id="imagePreviews">
                                        <!-- Preview slots will be added here dynamically -->
                                    </div>
                                </div>

                                <div class="flex center mb-3 mt-12 fastadder-color-section">
                                    <div class="color-input-wrapper m-LR-2 fastadder-color-input">
                                        <div class="flex center align-items">
                                            <input id="Colorbg1" style="width:45px;" type="text" name="color"
                                                class="formbold-form-input fastadder-input">
                                            <input id="Color1" type="color" name="color-value"
                                                class="color-picker fastadder-color-picker">
                                            <input type="file" id="imageInput1" accept="image/png, image/jpeg"
                                                style="display: none;">
                                        </div>
                                        <div class="flex column align-items fastadder-color-buttons">
                                            <div class="change-ctib hidden fastadder-btn" id="change-ctib-1"
                                                title="change color as image"><i class="bi bi-images"></i></div>
                                            <div class="rtc-ctib" id="ReturnToColor-ctib-1" title="save image as color">
                                                <i class="bi bi-arrow-left-right"></i>
                                            </div>
                                        </div>
                                    </div>

                                    <input id="colorname1" type="text" name="color-name" style="width: 150px;"
                                        placeholder="Black" class="formbold-form-input m-LR-2 fastadder-input">
                                </div>

                                <div class="formbold-input-group fastadder-category-section">
                                    <div class="flex center align-items gap-20 sm640wrap fastadder-category-row">
                                        <div class="flex align-items gap-30 fastadder-category-group">
                                            <div class="fastadder-category-select">

                                                <div class="formbold-input-group m-LR-2">
                                                    <label for="category"
                                                        class="formbold-form-label txt-center">Category</label>
                                                    <div class="shadow">
                                                        <select name="category" id="category"
                                                            class="formbold-form-input s530150 font-sm  txt-center">
                                                            <option value="men">Men</option>
                                                            <option value="women">Women</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="formbold-input-group m-LR-2">
                                                    <label for="Piece"
                                                        class="formbold-form-label  txt-center">Piece</label>
                                                    <div class="shadow">
                                                        <select name="Piece" id="Piece"
                                                            class="formbold-form-input s530150 font-sm  txt-center">


                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="formbold-input-group m-LR-2">
                                                    <label for="Type"
                                                        class="formbold-form-label  txt-center">Type</label>
                                                    <div class="shadow">
                                                        <select name="Type" id="Type"
                                                            class="formbold-form-input s530150 font-sm  txt-center">
                                                            <option value="Top">Top</option>
                                                            <option value="Bottom">Bottom</option>
                                                            <option value="Footwear">Footwear</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="formbold-input-group fastadder-description">
                                            <label for="productdescription"
                                                class="formbold-form-label fastadder-label">Product
                                                Description</label>
                                            <textarea rows="9" name="product-description" id="productdescription"
                                                placeholder="Type product description here..."
                                                class="formbold-form-input shadow fastadder-textarea"></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>


                </div>

                <style>
                    /* Base Styles */
                    .fastadder-container {
                        font-family: 'Inter', sans-serif;
                        max-width: 1200px;
                        margin: 0 auto;
                        padding: 20px;
                    }

                    .fastadder-row {
                        margin-bottom: 30px;
                    }

                    .fastadder-input-group {
                        margin-bottom: 15px;
                        flex-wrap: wrap;
                    }



                    .fastadder-input:focus {
                        border-color: #6a64f1;
                        box-shadow: 0 3px 8px rgba(0, 0, 0, 0.05);
                    }

                    .shadow {
                        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
                    }

                    /* Product Record Section */


                    /* Size & Quantity Controls */
                    .fastadder-size-quantity {
                        flex-wrap: wrap;
                    }

                    .fastadder-input-buttons {
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }

                    .fastadder-button-group {
                        display: flex;
                        align-items: center;
                    }

                    .fastadder-btn {
                        background: none;
                        border: none;
                        cursor: pointer;
                        color: #6a64f1;
                        font-size: 16px;
                        transition: all 0.3s ease;
                        padding: 5px;
                        border-radius: 50%;
                    }



                    /* Image URLs Section */
                    .fastadder-image-urls {
                        display: none;
                        /* Hidden by default */
                        gap: 10px;
                    }

                    .fastadder-image-urls.active {
                        display: flex;
                    }

                    /* Master Drop Zone */
                    .fastadder-dropzone-container {
                        margin: 20px 0;
                    }

                    .fastadder-master-dropzone {
                        border: 1px dashed #ffffff2b;
                        border-radius: 12px;
                        padding: 40px 20px;
                        text-align: center;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        background: #0a0914;
                    }

                    .fastadder-master-dropzone:hover {
                        border-color: #6a64f1;
                    }

                    .fastadder-master-dropzone.drag-over {
                        border-color: #6a64f1;
                        background: #f0efff2a;
                    }

                    .fastadder-dropzone-content {
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        gap: 10px;
                    }

                    .fastadder-dropzone-content i {
                        font-size: 32px;
                        color: #6a64f1;
                    }

                    .fastadder-dropzone-hint {
                        font-size: 12px;
                        color: #888;
                        margin-top: 5px;
                    }

                    .fastadder-upload-status {
                        margin-top: 10px;
                        font-size: 14px;
                        color: #666;
                        text-align: center;
                    }

                    /* Image Previews */
                    .fastadder-image-previews {
                        padding: 10px;
                        border: 1px dashed #ffffff2b;
                        border-radius: 12px;
                        display: flex;
                        /* grid-template-columns: repeat(3, 1fr); */
                        gap: 15px;
                        margin-top: 20px;
                        flex-wrap: wrap;
                        justify-content: center;
                    }

                    .fastadder-image-preview:hover {
                        border-color: #6a64f1;
                        cursor: pointer;
                    }


                    .fastadder-image-preview {
                        width: fit-content;
                        position: relative;
                        border-radius: 8px;
                        overflow: hidden;
                    }

                    .fastadder-image-preview img {
                        padding: 5px;
                        width: 120px;
                        height: 120px;
                        object-fit: cover;
                    }

                    .fastadder-image-preview-main {
                        border: 2px solid #6a64f1;
                    }

                    .fastadder-image-preview-label {
                        position: absolute;
                        bottom: 0;
                        left: 0;
                        right: 0;
                        background: rgba(106, 100, 241, 0.8);
                        color: white;
                        font-size: 12px;
                        text-align: center;
                        padding: 3px 0;
                    }

                    /* Color Section */
                    .fastadder-color-section {
                        flex-wrap: wrap;
                        gap: 15px;
                    }

                    .fastadder-color-input {
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }

                    .fastadder-color-picker {
                        width: 30px;
                        height: 30px;
                        border: 1px solid #e0e0e0;
                        border-radius: 4px;
                        cursor: pointer;
                    }

                    .fastadder-color-buttons {
                        gap: 5px;
                    }

                    /* Category Section */
                    .fastadder-category-section {
                        margin-top: 30px;
                    }

                    .fastadder-category-row {
                        flex-wrap: wrap;
                    }

                    .fastadder-category-group {
                        flex-wrap: wrap;
                        width: -webkit-fill-available;
                        justify-content: center;
                    }

                    .fastadder-category-select {
                        display: flex;
                        gap: 15px;
                        min-width: 200px;
                    }

                    .fastadder-select {
                        width: 100%;
                        padding: 12px 16px;
                        border-radius: 6px;
                        border: 1px solid #e0e0e0;
                        background: #ffffff;
                        font-weight: 500;
                        font-size: 14px;
                        color: #ffffff;
                        outline: none;
                        cursor: pointer;
                    }

                    .color-picker {
                        border: transparent;
                    }

                    /* Description Section */
                    .fastadder-description {
                        flex: 1;
                        min-width: 300px;
                    }

                    .fastadder-textarea {
                        min-height: 150px;
                    }

                    /* Responsive Adjustments */
                    @media (max-width: 768px) {
                        .fastadder-prices {
                            flex-direction: column;
                        }

                        .fastadder-image-previews {
                            grid-template-columns: repeat(2, 1fr);
                        }
                    }

                    @media (max-width: 480px) {
                        .fastadder-image-previews {
                            grid-template-columns: 1fr;
                        }
                    }

                    .fastadder-image-preview {
                        position: relative;
                        display: inline-block;
                        margin: 5px;
                        border: 1px solid #dddddd75;
                        border-radius: 4px;
                        transition: all 0.3s ease;
                    }

                    .fastadder-image-preview img {
                        display: block;
                        width: 120px;
                        height: 120px;
                        object-fit: cover;
                    }

                    .fastadder-image-preview.dragging {
                        opacity: 0.5;
                    }

                    .fastadder-image-preview.drag-over {
                        border-color: #6a64f1;
                        transform: scale(1.05);
                    }

                    .fastadder-preview-actions {
                        position: absolute;
                        bottom: 0;
                        left: 0;
                        right: 0;
                        display: flex;
                        justify-content: space-around;
                        background: rgb(0 0 0 / 73%);
                        padding: 5px;
                        align-items: center;
                        transition: opacity 0.3s ease;
                    }

                    .fastadder-preview-actions button {
                        background: none;
                        border: none;
                        color: white;
                        cursor: pointer;
                        font-size: 14px;
                    }

                    .fastadder-preview-actions .set-main-btn {
                        display: flex;
                        color: #6a64f1;
                        align-items: center;
                        justify-content: center;
                    }

                    .fastadder-image-preview.main-image {
                        border-color: #6a64f1;
                    }

                    .main-image-label {
                        z-index: 100;
                        position: absolute;
                        top: 0px;
                        right: 0px;
                        background: #6a64f1;
                        color: black;
                        padding: 2px 5px;
                        /* border-radius: 3px; */
                        font-size: 12px;
                        font-weight: bold;
                    }

                    .fastadder-preview-index {
                        z-index: 1000;
                        position: absolute;
                        top: 0px;
                        left: 0px;
                        background: rgb(77 77 77);
                        color: white;
                        /* border-radius: 50%; */
                        width: 20px;
                        height: 16px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-size: 12px;
                    }

                    #masterDropZone {
                        cursor: pointer;
                    }

                    .fastadder-image-preview:hover .fastadder-preview-actions {
                        opacity: 1;
                    }

                    .set-main-btn,
                    .remove-btn {
                        cursor: pointer;
                        padding: 3px;
                        border-radius: 50%;
                        width: 24px;
                        height: 24px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        transition: all 0.3s ease;
                    }

                    .set-main-btn {
                        color: #ccc;
                    }

                    .set-main-btn:hover {
                        color: #6a64f1;
                        background: rgb(171 171 171);
                    }

                    .set-main-btn i.bi-star {
                        transition: all 0.3s ease;
                    }

                    .set-main-btn:hover i.bi-star {
                        font-variation-settings: 'FILL' 1;
                    }

                    .remove-btn {
                        color: #ccc;
                    }

                    .remove-btn:hover {
                        color: #ff4444;
                        background: rgba(255, 68, 68, 0.2);
                    }

                    /* For the main image state (when starred) */
                    .fastadder-image-preview.main-image .set-main-btn {
                        color: #6a64f1;
                    }

                    .fastadder-image-preview.main-image .set-main-btn i.bi-star {
                        font-variation-settings: 'FILL' 1;
                    }
                </style>

                <script>

                    // Size options in order
                    const SIZE_OPTIONS = ['XS', 'S', 'M', 'L', 'XL', 'XXL', 'XXXL'];

                    // Increment function with size looping
                    function fastadderincrement(event) {
                        const input = event.currentTarget.closest('.fastadder-input-buttons').querySelector('input');
                        const currentValue = input.value.toUpperCase();

                        if (SIZE_OPTIONS.includes(currentValue)) {
                            // Handle size increment with looping
                            const currentIndex = SIZE_OPTIONS.indexOf(currentValue);
                            const nextIndex = (currentIndex + 1) % SIZE_OPTIONS.length;
                            input.value = SIZE_OPTIONS[nextIndex];
                        } else {
                            // Handle numeric increment
                            const value = parseInt(input.value) || 0;
                            input.value = value + 1;
                        }
                    }

                    // Decrement function with size looping
                    function fastadderdecrement(event) {
                        const input = event.currentTarget.closest('.fastadder-input-buttons').querySelector('input');
                        const currentValue = input.value.toUpperCase();

                        if (SIZE_OPTIONS.includes(currentValue)) {
                            // Handle size decrement with looping
                            const currentIndex = SIZE_OPTIONS.indexOf(currentValue);
                            const prevIndex = (currentIndex - 1 + SIZE_OPTIONS.length) % SIZE_OPTIONS.length;
                            input.value = SIZE_OPTIONS[prevIndex];
                        } else {
                            // Handle numeric decrement
                            const value = parseInt(input.value) || 0;
                            input.value = Math.max(0, value - 1);
                        }
                    }
                    function toggleImageInputs() {
                        // Get the elements
                        const toggleButton = document.querySelector('.show-img-url');
                        const toggleContainer = document.querySelector('.fastadder-toggle-images');
                        const imageInputsContainer = document.getElementById('image-inputs');

                        // Toggle the height and class
                        if (!imageInputsContainer.classList.contains("open")) {
                            // Open state
                            imageInputsContainer.classList.add('open');
                            toggleButton.innerHTML = 'Hide Images Urls <i class="bi bi-eye-slash-fill"></i>';
                        } else {
                            // Closed state
                            imageInputsContainer.classList.remove('open');
                            toggleButton.innerHTML = 'Show Images Urls <i class="bi bi-eye-fill"></i>';
                        }
                    }


                    function toggleSize(event) {
                        const button = event.currentTarget;
                        const inputs = button.closest('.fastadder-input-group').querySelectorAll('input');
                        const sizeOptions = ['XS', 'S', 'M', 'L', 'XL', 'XXL', 'XXXL'];

                        // Check if either input contains a size (not a number)
                        const isSizeMode = sizeOptions.some(size =>
                            inputs[0].value.toUpperCase() === size ||
                            inputs[1].value.toUpperCase() === size
                        );

                        if (isSizeMode) {
                            // Switch to numeric mode (0-0)
                            inputs[0].value = '0';
                            inputs[1].value = '0';
                            button.innerHTML = '<i class="bi bi-arrow-repeat"></i>';
                        } else {
                            // Switch to size mode (keep current size range if possible)
                            const fromSize = sizeOptions.includes(inputs[0].value.toUpperCase()) ?
                                inputs[0].value.toUpperCase() : 'XS';
                            const toSize = sizeOptions.includes(inputs[1].value.toUpperCase()) ?
                                inputs[1].value.toUpperCase() : 'XXXL';

                            inputs[0].value = fromSize;
                            inputs[1].value = toSize;
                            button.innerHTML = '<i class="bi bi-arrow-repeat"></i>';
                        }
                    }
                    // // This would be your JavaScript to handle the master drop zone functionality


                    //             function handleMasterDrop(e, dropzone) {
                    //                 e.preventDefault();
                    //                 dropzone.classList.remove('drag-over');

                    //                 const files = e.dataTransfer.files;
                    //                 const previewContainer = document.getElementById('imagePreviews');
                    //                 previewContainer.innerHTML = '';

                    //                 // Limit to 6 files
                    //                 const fileList = Array.from(files).slice(0, 6);

                    //                 fileList.forEach((file, index) => {
                    //                     if (file.type.match('image.*')) {
                    //                         const reader = new FileReader();

                    //                         reader.onload = function (e) {
                    //                             const preview = document.createElement('div');
                    //                             preview.className = 'fastadder-image-preview' + (index < 2 ? ' fastadder-image-preview-main' : '');

                    //                             preview.innerHTML = `
                    //                 <img src="${e.target.result}" alt="Preview">
                    //                 ${index < 2 ? '<div class="fastadder-image-preview-label">Main Image</div>' : ''}
                    //               `;

                    //                             previewContainer.appendChild(preview);
                    //                         }

                    //                         reader.readAsDataURL(file);
                    //                     }
                    //                 });

                    //                 // Update status
                    //                 const status = document.getElementById('masterUploadStatus');
                    //                 status.textContent = `Uploaded ${fileList.length} image(s) - First 2 are main images`;
                    //             }

                    //             function handleDragOver(e, dropzone) {
                    //                 e.preventDefault();
                    //                 dropzone.classList.add('drag-over');
                    //             }

                    //             function handleDragLeave(e, dropzone) {
                    //                 e.preventDefault();
                    //                 dropzone.classList.remove('drag-over');
                    //             }
                    //             // Image selection from device
                    //             function openImagePicker(event) {
                    //                 const fileInput = document.createElement('input');
                    //                 fileInput.type = 'file';
                    //                 fileInput.multiple = true;
                    //                 fileInput.accept = 'image/*';

                    //                 fileInput.addEventListener('change', (e) => {
                    //                     const files = Array.from(e.target.files).slice(0, 6);
                    //                     const previewContainer = document.getElementById('imagePreviews');
                    //                     previewContainer.innerHTML = '';

                    //                     files.forEach((file, index) => {
                    //                         const reader = new FileReader();
                    //                         reader.onload = (event) => {
                    //                             const preview = document.createElement('div');
                    //                             preview.className = 'fastadder-image-preview';

                    //                             // Add badge to first 2 images
                    //                             let badgeText = '';
                    //                             if (index === 0) {
                    //                                 badgeText = '<div class="fastadder-image-preview-label">Main Image</div>';
                    //                             } else if (index === 1) {
                    //                                 badgeText = '<div class="fastadder-image-preview-label">Main Image</div>';
                    //                             }

                    //                             preview.innerHTML = `
                    //   <img src="${event.target.result}" alt="Preview">
                    //   ${badgeText}
                    // `;

                    //                             previewContainer.appendChild(preview);

                    //                             // Update corresponding input field
                    //                             const inputId = `img${index + 1}_1`;
                    //                             const input = document.getElementById(inputId);
                    //                             if (input) input.value = event.target.result;
                    //                         };
                    //                         reader.readAsDataURL(file);
                    //                     });

                    //                     // ... rest of your existing code ...
                    //                 });
                    //                 fileInput.click();
                    //             }
                    //             // Add click event to your drop div
                    //             document.getElementById('masterDropZone').addEventListener('click', openImagePicker);

                    function handleMasterDrop(e, dropzone) {
                        e.preventDefault();
                        dropzone.classList.remove('drag-over');
                        const files = e.dataTransfer.files;
                        processFiles(files);
                    }

                    function processFiles(files) {
                        const previewContainer = document.getElementById('imagePreviews');
                        previewContainer.innerHTML = '';

                        // Limit to 6 files
                        const fileList = Array.from(files).slice(0, 6);

                        fileList.forEach((file, index) => {
                            if (file.type.match('image.*')) {
                                const reader = new FileReader();
                                reader.onload = function (e) {
                                    createImagePreview(e.target.result, index, previewContainer);
                                }
                                reader.readAsDataURL(file);
                            }
                        });

                        updateUploadStatus(fileList.length);
                    }

                    function createImagePreview(imageSrc, index, container) {
                        const preview = document.createElement('div');
                        preview.className = 'fastadder-image-preview draggable-preview';
                        preview.dataset.index = index;
                        preview.draggable = true;

                        preview.innerHTML = `
        <img src="${imageSrc}" alt="Preview">
        <div class="fastadder-preview-actions">
            <div class="set-main-btn" title="Set as main image"><i class="bi bi-star"></i></div>
            <div class="remove-btn" title="Remove image"><i class="bi bi-x"></i></div>
        </div>
        <div class="fastadder-preview-index">${index + 1}</div>
    `;

                        // Add event listeners
                        preview.addEventListener('dragstart', handleDragStart);
                        preview.querySelector('.set-main-btn').addEventListener('click', toggleMainImage);
                        preview.querySelector('.remove-btn').addEventListener('click', removeImage);

                        container.appendChild(preview);
                        setupDragAndDrop(preview);
                    }

                    function toggleMainImage(e) {
                        e.stopPropagation();
                        const preview = this.closest('.fastadder-image-preview');
                        preview.classList.toggle('main-image');

                        // Update the label
                        const label = preview.querySelector('.main-image-label') || document.createElement('div');
                        if (preview.classList.contains('main-image')) {
                            label.className = 'main-image-label';
                            label.textContent = 'Main Image';
                            if (!preview.querySelector('.main-image-label')) {
                                preview.querySelector('img').insertAdjacentElement('afterend', label);
                            }
                        } else {
                            label.remove();
                        }
                    }

                    function removeImage(e) {
                        e.stopPropagation();
                        const preview = this.closest('.fastadder-image-preview');
                        preview.remove();
                        reorderPreviews();
                    }

                    let draggedItem = null;

                    function handleDragStart(e) {
                        draggedItem = this;
                        e.dataTransfer.effectAllowed = 'move';
                        this.classList.add('dragging');
                    }

                    function setupDragAndDrop(preview) {
                        preview.addEventListener('dragover', function (e) {
                            e.preventDefault();
                            this.classList.add('drag-over');
                        });

                        preview.addEventListener('dragleave', function () {
                            this.classList.remove('drag-over');
                        });

                        preview.addEventListener('drop', function (e) {
                            e.preventDefault();
                            this.classList.remove('drag-over');

                            if (draggedItem !== this) {
                                const previews = Array.from(document.querySelectorAll('.fastadder-image-preview'));
                                const draggedIndex = previews.indexOf(draggedItem);
                                const targetIndex = previews.indexOf(this);

                                if (draggedIndex < targetIndex) {
                                    this.after(draggedItem);
                                } else {
                                    this.before(draggedItem);
                                }

                                reorderPreviews();
                            }
                        });

                        preview.addEventListener('dragend', function () {
                            this.classList.remove('dragging');
                        });
                    }

                    function reorderPreviews() {
                        const previews = document.querySelectorAll('.fastadder-image-preview');
                        previews.forEach((preview, index) => {
                            preview.dataset.index = index;
                            preview.querySelector('.fastadder-preview-index').textContent = index + 1;
                        });
                    }

                    function updateUploadStatus(count) {
                        const status = document.getElementById('masterUploadStatus');
                        status.textContent = `Uploaded ${count} image(s) - Click stars to set main images`;
                    }

                    // Enhanced image picker function
                    function openImagePicker(event) {
                        const fileInput = document.createElement('input');
                        fileInput.type = 'file';
                        fileInput.multiple = true;
                        fileInput.accept = 'image/*';

                        fileInput.addEventListener('change', (e) => {
                            processFiles(e.target.files);
                        });
                        fileInput.click();
                    }

                    // Initialize
                    document.getElementById('masterDropZone').addEventListener('click', openImagePicker);
                    document.getElementById('masterDropZone').addEventListener('dragover', function (e) {
                        e.preventDefault();
                        this.classList.add('drag-over');
                    });
                    document.getElementById('masterDropZone').addEventListener('dragleave', function (e) {
                        e.preventDefault();
                        this.classList.remove('drag-over');
                    });
                    document.getElementById('masterDropZone').addEventListener('drop', function (e) {
                        handleMasterDrop(e, this);
                    });
                </script>
                <div class="flex center">
                    <button id="sub-btn" type="submit"
                        class="formbold-btn formbold-sub-btn flex center align-items gap-10">
                        <div id="sub-txt">Submit</div>
                        <div id="sub-spin" class="spinner-sm hidden">
                        </div>
                    </button>
                </div>
            </form>

            <script>
                document.addEventListener("DOMContentLoaded", () => {
                    // Dark & Light toggle
                    document.querySelector(".day-night").addEventListener("change", () => {
                        const body = document.querySelector("body");
                        body.classList.toggle("dark");

                        if (body.classList.contains("dark")) {
                            setTimeout(() => {
                                body.classList.toggle("light");
                                setTimeout(() => body.classList.remove("light"), 10);
                            }, 5);
                        }

                        // Toggle input and label styles
                        const inputs = document.querySelectorAll("input");
                        const labels = document.querySelectorAll("label");

                        inputs.forEach(input => {
                            if (body.classList.contains("dark")) {
                                input.style.color = "#888888";
                                input.style.borderColor = "#8e8e8e80";
                            } else {
                                input.style.color = "";
                                input.style.borderColor = "";
                            }
                        });

                        labels.forEach(label => {
                            if (body.classList.contains("dark")) {
                                label.style.color = "#545454";
                            } else {
                                label.style.color = "";
                            }
                        });
                    });
                });
            </script>
            <script>
                function toggleDropdown() {
                    const dropdown = document.getElementById('dropdown');
                    dropdown.classList.toggle('active');
                }

                document.addEventListener("DOMContentLoaded", () => {
                    // Close dropdown if clicked outside
                    document.addEventListener('click', function (event) {
                        const profileIcon = document.querySelector('.profile-icon');
                        const dropdown = document.getElementById('dropdown');
                        if (!profileIcon.contains(event.target)) {
                            dropdown.classList.remove('active');
                        }
                    });



                });
            </script>


            <style>
                /* Default styles for inputs and labels */
                input {
                    color: inherit;
                    border-color: inherit;
                }

                label {
                    color: inherit;
                }

                /* Styles for dark mode */
                body.dark input {
                    color: #888888;
                    border-color: #8e8e8e80;


                }

                body.dark select {
                    color: #888888;
                    border-color: #8e8e8e80;
                    background: black;
                    ;
                }

                body.dark label {
                    color: #545454;
                    border-color: #8e8e8e80;
                }

                body.dark textarea {
                    color: #545454;
                    border-color: #8e8e8e80;
                }

                body.dark button {
                    color: white;
                    background-color: black;
                }

                body.dark .formbold-sub-btn {
                    color: white;
                    background-color: #6a64f1 !important;
                }

                body.dark .swal2-container.swal2-center.swal2-backdrop-show div {
                    background-color: #141414
                }

                body.dark .swal2-success-ring {
                    background: none !important;
                }

                body.dark .swal2-success-circular-line-left {
                    background-color: inherit !important;
                }

                body.dark .swal2-success-circular-line-right {
                    background-color: inherit !important;
                }

                body.dark .swal2-success-fix {
                    background-color: inherit !important;
                }
            </style>

        </div>
        </div>

    </main>

    <script src="./js/imageupload.js"></script>
    <script src="./js/handling-piece.js"></script>
    <script src="./js/PreviewProduct.js"></script>
    <script src="./js/change-color-to-img.js"></script>
    <script>
        window.addEventListener("beforeunload", function (event) {
            const inputContainer = document.getElementById("input-container");

            // If inputContainer has content, show the alert
            if (inputContainer && inputContainer.innerHTML.trim() !== "") {
                event.preventDefault(); // Prevents the default browser alert
                event.returnValue = ""; // Required for some browsers

                // Show SweetAlert instead
                // showCustomReloadAlert();
                return ""; // Older browser support
            }
        });


    </script>
    <script>const productPriceInput = document.getElementById("productprice");
        const saleAmountInput = document.getElementById("sale-amount");
        const pricePlusCutInput = document.getElementById("priceplusthecut");
        const finalPriceInput = document.getElementById("finalprice");
        const storePriceInput = document.getElementById("Storeprice");
        // This will store the current cut value
        let currentCut = 0;

        function calculateFinalPrice() {
            const productPrice = parseFloat(productPriceInput.value) || 0;
            const saleAmount = parseFloat(saleAmountInput.value) || 0;

            // Calculate initial cut
            const matagerCut = productPrice * matager_percentage;
            const pricePlusCut = Math.ceil(productPrice + matagerCut);
            pricePlusCutInput.value = pricePlusCut;

            // Calculate discount and final price
            const discount = pricePlusCut * (saleAmount / 100);
            const finalPrice = Math.ceil(pricePlusCut - discount);
            finalPriceInput.value = finalPrice;
            storePriceInput.value = finalPrice;

            // Store the current cut value (adjusted for sale if any)
            currentCut = Math.ceil(matagerCut - matagerCut * (saleAmount / 100));

            return currentCut;
        }

        // Add event listeners
        productPriceInput.addEventListener("input", calculateFinalPrice);
        saleAmountInput.addEventListener("input", calculateFinalPrice);</script>

</body>

</html>